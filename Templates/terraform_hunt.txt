
resource "azurerm_log_analytics_saved_search" "hunt_{{GUID}}" {
  // https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/log_analytics_saved_search
  name                       = "{{GUID}}"
  log_analytics_workspace_id = var.log_analytics_workspace_id

  category     = "Hunting Queries"
  display_name = "{{Name}}"

    tags = {
    "tactics"                     = "{{Tactics}}",
    "techniques"                  = "{{RelevantTechniques}}",
    "description"                 : "{{Description}}", // Should be limited only to max length here
    "id"                          = "{{Id}}",
    "alert_rule_template_version" : "{{Version}}"
  }
  query        = <<QUERY
  {{Query}}

  QUERY
}

// TODO: alternating between equals and colon inside tags, correct or not?