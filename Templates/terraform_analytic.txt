resource "azurerm_sentinel_alert_rule_scheduled" "ar_{{GUID}}" {
  // https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sentinel_alert_rule_scheduled
  name                       = "{{GUID}}"
  log_analytics_workspace_id = var.log_analytics_workspace_id
  display_name               = "{{Name}}"
  severity                   = "{{Severity}}"

  tactics                    = ["{{Tactics}}"] // Should be comma separated and quoted
  techniques                 = ["{{RelevantTechniques}}"] // Should be comma separated and quoted, and no subtechniques
  alert_details_override     = {{}}
  alert_rule_template_guid   = "{{Id}}"
  alert_rule_template_version = "{{Version}}"

  trigger_threshold         = {{TriggerThreshold}}

  custom_details
  description               = {{Description}}
  enabled
  entity_mapping            = {{EntityMappings}}
  event_grouping {
    aggregation_method = "AlertPerResult"
  }
  incident {
    create_incident_enabled = true
    grouping {
      enabled                = true
      entity_matching_method = "Selected"
      lookback_duration      = "PT8H"
      by_entities            = ["Account"]
    }
  }
  query_frequency            = {{QueryFrequency}}
  query_period               = {{QueryPeriod}}
  query                      = <<QUERY
{{Query}}
QUERY
}